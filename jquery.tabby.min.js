/**
 * @author Dan Bettles <dan@powder-blue.com>
 * @copyright Powder Blue Ltd 2015
 * @license MIT
 */

!function(){"use strict";function t(t,e){var s;s=jQuery.extend({createTabs:!1,select:jQuery.noop},e||{}),this.setEl(t),this.setOptions(s),this.setTabsEl(void 0)}t.CSS_CLASS_SELECTED="tabby-selected",t.prototype={setEl:function(t){return this.$el=t,this},getEl:function(){return this.$el},setOptions:function(t){return this.options=t,this},getOptions:function(){return this.options},findTabsEl:function(){return this.getEl().children("ul, ol").first()},setTabsEl:function(t){return this.$tabs=t,this},getTabsEl:function(){return this.$tabs},getTabEls:function(){return this.getTabsEl().children()},getPageEls:function(){return this.getEl().children().not(this.getTabsEl())},tabClick:function(e){var s,i,a;if(a=e.data("tabby-page-selector"),void 0===a?(s=e.index(),this.getPageEls().each(function(t){return t===s?(i=jQuery(this),!1):void 0})):i=this.getEl().find(a),!i||!i.size())throw"Failed to determine the page to select.";return this.getPageEls().removeClass(t.CSS_CLASS_SELECTED),i.addClass(t.CSS_CLASS_SELECTED),this.getTabEls().removeClass(t.CSS_CLASS_SELECTED),e.addClass(t.CSS_CLASS_SELECTED),this.getOptions().select.call(this,void 0,{panel:i}),this},setUp:function(){var t,e=this;if(!this.getOptions().createTabs){if(t=this.findTabsEl(),!t.size())throw"Failed to find tabs.";this.setTabsEl(t)}if(!this.getTabsEl()||!this.getTabsEl().size())throw"There are no tabs.";return this.getEl().addClass("tabby"),this.getTabsEl().addClass("tabby-tabs"),this.getTabEls().each(function(){var t,s,i,a=jQuery(this);t=a.find("a"),t.size()&&(t.click(function(t){t.preventDefault()}),s=t.first().attr("href"),i=s.match(/^(#.*)$/),null!==i&&a.data("tabby-page-selector",i[1])),a.click(function(){e.tabClick(jQuery(this))}).addClass("tabby-tab")}),this.getPageEls().addClass("tabby-page"),this.tabClick(this.getTabEls().first()),this}},jQuery.fn.extend({tabby:function(e){return this.each(function(){var s=jQuery(this);s.data("tabby",new t(s,e)).data("tabby").setUp()})}})}();